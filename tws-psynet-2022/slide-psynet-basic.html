<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>横断的ネットワーク解析：基礎編</title>
    <meta charset="utf-8" />
    <meta name="author" content="国里愛彦（専修大学）" />
    <script src="slide-psynet-basic_files/header-attrs-2.14/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# 横断的ネットワーク解析：基礎編
]
.subtitle[
## TWS-007「心理ネットワークアプローチ入門」
]
.author[
### 国里愛彦（専修大学）<img style="float:right" src="fig/yk.png" width="250">
]
.date[
### 日本心理学会(2022年)
]

---




# 配布資料


![](fig/qr.png)
---
## 心理ネットワークとは？

- 潜在変数を仮定してそれから各項目・症状を説明するのではなく，症状（心理変数）間のネットワーク構造を検討する.med[(Epskamp, Borsboom &amp; Fried, 2018)]。
- 観察可能な変数を表すノード（図では円）と統計的関係を表すエッジ（図では線）から構成される

![](fig/net01.png)
---

## 心理ネットワーク分析の手順

1. 統計的手法によってノード間のエッジを推定する
2. 推定された統計的関係をもとにネットワークを図示する
3. ネットワーク特性の指標の検討する
4. ネットワークの精度の検討する


- 心理ネットワークのエッジは，データから推定される（重み付きネットワーク）

→(1)サンプルサイズの影響を受けるのでエッジの精度を検討する，(2)グローバルなネットワーク特性.med[(small worldnessなど)]は使えないので，ローカルなネットワーク特性.med[(中心性指標)]を用いる。
---

## 有向・無向ネットワーク

- 有向ネットワークはエッジに方向性があるネットワーク.med[(左図）]，無向ネットワークは方向性がないネットワーク.med[（右図）]
- エッジの矢印は因果関係を示唆しているが，横断データではそれは難しいので，以下では無向ネットワークを用いる

![](fig/net06.png)
---

## エッジの見方

- **エッジの色** 符号を意味しており，青もしくは緑の場合は正，赤の場合は負を表す。
- **エッジの太さ** 全体のノードからの影響を考慮した時の２つのノード間の関係の強さ
- **エッジの長さ** エッジの強さの逆数であり，関係が強ければ強いほど短くなる。

![](fig/net01.png)
---
## ペアワイズマルコフ確率場

- 無向ネットワークモデルの推定では，ペアワイズ・マルコフ確率場(pairwise Markov random field)がよく使われる.med[(Epskamp, Haslbeck, Isvoranu,&amp; Van Borkulo, 2022)]
- 心理ネットワーク分析の主なペアワイズ・マルコフ確率場のモデルは以下に３つがある（全て重み付きネットワーク）

1. **Gaussian graphical model (GGM)**: 連続変数のデータ.med[(エッジの値は-1から1の範囲)]
2. **Ising model**: 2値変数のデータ.med[(エッジの値は-∞から∞の範囲)]
3. **mixed graphical models (MGMs)**: 2値変数と連続変数の混ざったデータ.med[(エッジの値は-1から1の範囲)]

---
## Gaussian graphical model(GGM)

- データが連続かつ正規分布の場合には，多変量正規分布を用いたGGMを用いる。GGMでは変数間の関係を偏相関係数によってモデル化する。


- **Y**は，平均 `\(\boldsymbol{\mu}\)` と分散共分散行列 `\(\boldsymbol{\sum}\)` の多変量正規分布に従う.med[(**Y**は，ランダムに選んだ参加者からのn個の反応のベクトル)]

$$
\boldsymbol{Y} \sim N\left(\boldsymbol{\mu}, \boldsymbol{\sum}\right)
$$  

- GGMでは，推定した分散共分散行列 `\(\boldsymbol{\sum}\)`から偏相関行列を計算する。
---
## 分散共分散行列→精度行列→偏相関行列

- GGMでは，分散共分散行列 `\(\boldsymbol{\sum}\)` からその逆行列である精度行列  `\(\boldsymbol{K}\)` を計算し，精度行列から偏相関行列を計算する。
- 精度行列  `\(\boldsymbol{K}\)` は， `\(\boldsymbol{\sum}\)` の逆行列( `\(\boldsymbol{K}=\boldsymbol{\Sigma}^{-1}\)` )として求める.med[(逆行列はΣ に掛けた場合に単位行列になるような行列)]
- 以下の式で精度行列から偏相関係数を計算し，偏相関係数をエッジにしてネットワークをプロットする。

`$$\operatorname{Cor}\left(Y_{i}, Y_{j} \mid \boldsymbol{y}_{-(i, j)}\right)=-\frac{\kappa_{i j}}{\sqrt{\kappa_{i i}} \sqrt{\kappa_{j j}}}$$`

- 具体的な計算例は配布したドキュメントに記載している。

---
## Ising モデル  

- 元々は磁性体に関する統計力学的モデルだが，２値データのネットワークの記述に使えるのと，相転移なども扱える
- ２値反応のペアの同時確率をモデル化.med[(Epskamp et al., 2022) ]


`$$\operatorname{Pr}(\boldsymbol{Y}=\boldsymbol{y})=\frac{1}{Z} \exp \left(\sum_{i} y_{i} \tau_{i}+\sum_{&lt;i, j&gt;} y_{i} y_{j} \omega_{i j}\right)%$$`  
- τは閾値(どっちの反応が出やすいか），ωはノード間の反応の類似度を表す。Zは確率の合計が１になるように機能する
- Zの計算は，**Y**の全ての可能性について考慮するので20変数以上の多変量推定は難しい.med[(その場合は，単変量推定)]

---
## Mixed graphical models(MGMs)

- 連続，カウント，カテゴリカル変数が混ざったデータに適用できる.med[(Epskamp et al., 2022)] 
- データのタイプに合わせてノードごとに確率分布が適用.med[(ただし，全て指数分布族正規分布，ポワソン分布，指数分布，多項分布）]
- ノードごとに回帰分析によって推定し，すべての推定されたパラメータが最終モデルで統合される。
- MGMsは，ペアワイズである必要もなくて，高次の相互作用を含めたmoderated network modelも検討できる。

---
## モデル選択

- ネットワークは，エッジが１つもないものから全てのノード間にエッジがある飽和モデルの間に，大量のネットワークの可能性がある.med[(Blanken, Isvoranu &amp; Epskamp, 2022 )]
- オッカムの剃刀に従い，パフォーマンスを下げないようにして，シンプルなモデルを選ぶ。心理ネットワーク分析でのモデル選択として以下の４つがある。

1. しきい値(Thresholding)
2. 刈り込み(Pruning)
3. モデル探索(model search)
4. 正則化(regularization)

---
**しきい値(Thresholding)**

- しきい値では，ある基準.med[（p値, false discovery rate, credibility interval, Bayes factor）]に基づいて，エッジを除去する.med[（エッジを0に設定）]
- 基準以下エッジを見せてないだけで影響は残る

**刈り込み(Pruning)**

- 刈り込みでは，ある基準.med[（p値, false discovery rate, credibility interval, Bayes factor）]に基づいて，除去した上で.med[（エッジを0に設定）]，**再推定する**。
- 再推定するので，基準以下のエッジを0としたときのネットワークが推定される。

---
**モデル探索(model search)**

- 可能なネットワークを反復的に探索して最もデータフィットしたモデルを選ぶ.med[（AIC, BIC, EBICなどの情報量規準を用いる])
- Step-upでは，エッジがゼロから徐々にエッジを足して，情報量規準が最小のネットワークを探索.med[（Step-downは逆）]

**正則化(regularization)**

- モデルの複雑さに罰則をかけて，ネットワークを疎.med[(sparse)]にする。影響力が弱いエッジはゼロに近づき単純化できる。
- LASSO .med[(least absokute shrinkage and selection operator)]の一種のGraphical LASSOを使う。罰則の強さの調整は，cross-validation(CV)やEBICを使う。
---
## GGMでのモデル選択の推奨.med[(Isvoranu &amp; Epskamp, 2021)]

- (1)サンプルサイズが5000の場合，真のネットワークの探索には，正則化しないモデル探索が好ましい。
- (2)サンプルサイズが300の場合，ネットワーク構造の発見には，正則化が好ましい。
- (3)サンプルサイズが1000の場合，ネットワーク構造や強いエッジに興味があるなら正則化，特定のエッジに関心があるならモデル探索が好ましい。

---
** 順序カテゴリカル・非正規変数でのモデル選択の推奨.med[(Blanken, Isvoranu &amp; Epskamp, 2022)]**

- 順序カテゴリ変数の場合はポリコリック相関を使う。小サンプルサイズでは不安定になる.med[（psychonetricsパッケージの推定法やBGGMパッケージを使う）]
- 正規分布していないデータの場合は，スピアマンの順位相関係数をrank-transformationしてからGGMを行う。

**IsingモデルとMGMsでのモデル選択の推奨.med[(Blanken, Isvoranu &amp; Epskamp, 2022)]**
- Isingmモデルの場合，小中サンプルサイズでは正則化手法が見やすく，大サンプルサイズでは非正則化手法も使える。現状，MGMsで使えるのは正則化手法のみ。

---
### サンプルサイズ

- Isvoranu &amp; Epskamp(2021)の大規模シミュレーションによると，ノードは３０より少ないのが望ましく，できるだけサンプルサイズが大きいほうが望ましい
- 研究目的がネットワークの構造を調べるより，特定のエッジに焦点をしぼった方が大きなサンプルサイズが必要

### 欠測処理

- bootnetパッケージの場合は，欠測値があると推定ができないが，psychonetricsパッケージの場合は完全情報最尤推定法が使える(estimator = "FIML")。

---
### エッジの解釈法

- PRMFのエッジは，２変数以外の影響も考慮した２変数の関係を表す。２変数だけでなくネットワーク全体を考慮した解釈が必要になる。解釈としては以下の２つがある。
- (1)予測可能性の示唆: 他の変数の影響を考慮しても，ある変数から別の変数が予測できる可能性がある。A-B-Cという形でエッジがある場合に，BはAやCを予測する可能性がある。
- (2)因果関係の示唆: 因果の方向性は不明だが，そのエッジにはなんらかの因果的な効果がある可能性はある.med[(逆にいうと，強い理論的予測による仮説検証の結果のような解釈はしない)]。

---
## ノードの中心性指標

心理ネットワーク分析で使えるネットワークの指標として，Strength，Closeness，Betweenessがある。

- **Strength**:あるノードがつながっている全てのエッジの強さの合計。あるノードの全体に対する影響力を示している。
- **Closeness**: あるノードと他の全てのノード間の最短経路長の合計の逆数。あるノードがどのくらい間接的な影響を含めて他のノードとつながっているのかを示している。
- **Betweeness**: 2つのノード間の最短経路上に，あるノードが何回あるのかを示している。あるノードが2つのノードの接続においてどのくらい重要かを示している。

---
## エッジの正確度と中心性指標の安定性

- 推定されたエッジはサンプルやサンプルサイズの影響をうけるので，正確度(accuracy)や安定性(Stability)を検討する.med[(Epskamp, Borsboom,&amp; Fried, 2018)]

1. ブートストラップ法による信頼区間をプロットすることでエッジの重みの正確度を検討する .med[(有意性の検討には使わない)]
2. データのサブセットを用いた場合の中心性指標の安定性を検討する .med[(サンプルサイズを小さくしても安定するか検討，CS係数が0.25未満は不適切であり0.5を超えている必要がある)]
3. エッジの重みと中心性指標間でブートストラップ差異検定行って，それらが有意に異なるのかを検討する

---
## Rパッケージ 

- アムステルダム大学の[Sacha Epskamp](http://sachaepskamp.com/)が開発した[qgraph](https://cran.r-project.org/web/packages/qgraph/index.html)，[bootnet](https://cran.r-project.org/web/packages/bootnet/index.html)，[psychonetrics](https://cran.r-project.org/web/packages/psychonetrics/index.html)があれば，横断データの心理ネットワーク分析は実施できる。
- [qgraph](https://cran.r-project.org/web/packages/qgraph/index.html): ネットワークのプロットと推定
- [bootnet](https://cran.r-project.org/web/packages/bootnet/index.html):  様々な種類のネットワーク推定，ネットワークの正確度の検討
- [psychonetrics](https://cran.r-project.org/web/packages/psychonetrics/index.html)： より洗練化した書き方でネットワーク分析ができるパッケージ

アムステルダム大学で開発している統計ソフト[JASP](https://jasp-stats.org/)には，心理ネットワーク分析が組み込まれており，ちょっと試すのに便利

---
### 心理ネットワーク分析を試してみよう！

- 3404名からGAD-7(不安)，PHQ-9(うつ),PHQ-15(身体症状)を収集した[Jordan et al.(2017)](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0182162)のデータで試してみる。

### 使用するRパッケージの読み込み


```r
library(tidyverse)
library(foreign)
library(bootnet)
library(qgraph)
library(psychonetrics)
```

---
### データの読み込み

Jordan et al.(2017)のデータをダウンロードして，読み込む。


```r
download.file("https://doi.org/10.1371/journal.pone.0182162.s004","pone.0182162.s004.sav")
data &lt;- read.spss("pone.0182162.s004.sav", to.data.frame=TRUE)
```




GAD-7のデータを使う。renameで変数名を整理する。


```r
# データの整理
data_gad &lt;- data %&gt;% 
  rename(gad7a = S_GAD7_a, gad7b = S_GAD7_b, gad7c = S_GAD7_c, gad7d = S_GAD7_d,gad7e = S_GAD7_e, gad7f = S_GAD7_f, gad7g = S_GAD7_g) %&gt;% 
  select(gad7a, gad7b, gad7c, gad7d, gad7e, gad7f, gad7g)
```

---
## モデル選択： しきい値

- bootnetパッケージのestimateNetwork()関数で，「default = "pcor", threshold = "sig", alpha = 0.05」と指定する。
- GAD-7は４件法であり順序変数と考えられるので，ポリコリック相関を用いる.med[(「corMethod = "cor_auto"」と指定すると，７件法以下は自動的に順序変数としてポリコリック相関を計算してエッジの推定する)]。qgraphによるplotもいろいろな引数をもつので，描きたいグラフに合わせて設定する。


```r
results_gad &lt;- estimateNetwork(data_gad,default = "pcor", threshold = "sig", alpha = 0.05, corMethod = "cor_auto")
plot(results_gad, theme = "colorblind", cut = 0,layout = "spring",labels = TRUE)
```

---
## モデル選択： しきい値
![](slide-psynet-basic_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;
---
## モデル選択： 刈り込み

- psychonetricsパッケージのprune()関数を用いる。決めた基準以下のエッジを0に固定して再推定する。
- psychonetricsは，「使用するモデルにデータをいれて，パイプ演算子でrunmodelに送って推定し，prune()で刈り込みをして，getmatrixでエッジの情報を得て，プロットする」というように，パイプ演算子を使って書きやすい。


```r
ggm(data_gad) %&gt;%
  runmodel %&gt;%
  prune(alpha = 0.05) %&gt;%
  getmatrix("omega") %&gt;%
  qgraph(theme = "colorblind", cut = 0,layout = "spring",labels = TRUE)
```
---

## モデル選択： 刈り込み

![](slide-psynet-basic_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;
---
ggm()やIsng()の「omega="full"」で飽和モデルを推定


```r
ggm(data_gad,omega="full") %&gt;% runmodel %&gt;% getmatrix("omega") %&gt;%
  qgraph(theme = "colorblind", cut = 0,layout = "spring",labels = TRUE)
```

![](slide-psynet-basic_files/figure-html/unnamed-chunk-9-1.png)&lt;!-- --&gt;

---
ggm()やIsng()の「omega="empty"」でエッジ0モデルを推定


```r
ggm(data_gad,omega="empty") %&gt;%runmodel %&gt;%getmatrix("omega") %&gt;%
  qgraph(theme = "colorblind", cut = 0,layout = "spring",labels = TRUE)
```

![](slide-psynet-basic_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;

---
## モデル選択：モデル探索(Step-up)

エッジがない状態からエッジを足していって，BICが最小のモデルを選択するstepupは，以下のように実行する。


```r
ggm(data_gad, omega = "empty") %&gt;%
  runmodel %&gt;%
  stepup(criterion = "bic") %&gt;%
  getmatrix("omega") %&gt;%
  qgraph(theme = "colorblind", cut = 0,layout = "spring",labels = TRUE)
```
---
## モデル選択：モデル探索(Step-up)
![](slide-psynet-basic_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;
---
## モデル選択：モデル探索

モデル探索は以下のように行う。


```r
ggm(data_gad) %&gt;%
  runmodel %&gt;%
  modelsearch(criterion = "bic") %&gt;%
  getmatrix("omega") %&gt;%
  qgraph(theme = "colorblind", cut = 0,layout = "spring",labels = TRUE)
```
---
## モデル選択：モデル探索
![](slide-psynet-basic_files/figure-html/unnamed-chunk-14-1.png)&lt;!-- --&gt;
---
## モデル選択：正則化

- bootnetパッケージのestimateNetwork()関数を使って，EBICでモデル選択して，パラメータ調整をするGLASSOを使う(「default="EBICglasso"」を指定する）


```r
results_gad &lt;- estimateNetwork(data_gad,default = "EBICglasso", corMethod = "cor_auto")
```

推定したエッジをネットワークとしてプロットする


```r
plot(results_gad, theme = "colorblind", cut = 0,layout = "spring",labels = TRUE)
```

---
## モデル選択：正則化

以降は正則化手法を使ったネットワークで解析をすすめる。

![](slide-psynet-basic_files/figure-html/unnamed-chunk-17-1.png)&lt;!-- --&gt;

---
### エッジの重みの正確度

- bootnetパッケージのbootnet()関数を使う。nBootsでサンプル数を設定するが，プロットをなめらかにするために2500サンプルとする。nCoresで並列処理をして計算を高速化.med[(４コアに設定しているが，お手持ちのPCに合わせて変更ください)]
- 中心性指標も計算するために，statisticsで指定する。
- summaryで推定結果を確認できるが，プロットのほうが確認がしやすい。


```r
accuracy_edge &lt;- bootnet(results_gad, nBoots = 2500, nCores =4, statistics =   c("edge", "strength", "closeness", "betweenness"))
```

---


```r
plot(accuracy_edge, labels = FALSE, order = "sample")
```

![](fig/plot1.png)

サンプルサイズが大きいので95%信頼区間の幅は狭い

---
## 中心性の指標のプロット

- qgraphパッケージのcontralityPlot関数でプロットできる。includeで"Strength", "Betweenness", "Closeness"の３つを指定する.med[（デフォルトではStrengthのみが出力される）]



```r
centralityPlot(results_gad, include = c("Strength", "Betweenness", "Closeness"))
```

---
psychonetricsでは，以下のように書ける


```r
ggm(data_gad) %&gt;%　runmodel %&gt;%　getmatrix("omega") %&gt;%
  centralityPlot(include = c("Strength", "Betweenness", "Closeness"))
```

![](slide-psynet-basic_files/figure-html/unnamed-chunk-21-1.png)&lt;!-- --&gt;

---
## 中心性指標の安定性(Stability)

- bootnetパッケージのbootnet()関数を使う。「type = ”case”」を指定するとケースドロップ時の安定性を推定できる。
- 中心性の指標は複数あるので，statisticsで"strength", "closeness", "betweenness"を指定する。


```r
stability_centrality &lt;- bootnet(results_gad, nBoots = 2500, type = "case", nCores =4, statistics =  c("strength", "closeness", "betweenness"))
```

---



```r
plot(stability_centrality, c("strength", "closeness", "betweenness"))
```

![](fig/plot2.png)

- サンプルをかなり減らしても，オリジナルとの相関は高い。

---
- CS係数を確認する。StrengthとClosenessはCS係数が0.5を超えているが，Betweenessは低いので，解釈を控える必要がある。


```r
corStability(stability_centrality)
```

![](fig/plot3.png)
---
## 有意差検定

- Strengthに関して，最も高いgad7bと最も低いgad7fを比較する。
- bootnetパッケージのdifferenceTest()関数で検討できる。95%CIが0をまたいでおり，gad7bはgad7fよりも有意にstrengthが大きい。



```r
differenceTest(accuracy_edge, 2, 6, "strength")  
```

![](fig/plot4.png)
---
- エッジ間の差の検定結果をプロットする.med[(エッジ間で有意な差がある場合は黒く塗りつぶされ，有意ではない場合は灰色に塗りつぶされる)]


```r
plot(accuracy_edge, "edge", plot = "difference", onlyNonZero = TRUE, order = "sample")  
```

![](fig/plot5.png)
---
- 各ノード間のStrengthの差の検定結果をプロットする.med[(ノード間で有意な差がある場合は黒色，有意ではない場合は灰色に塗りつぶす)]


```r
plot(accuracy_edge,"strength")
```

![](fig/plot6.png)
---
## 横断的ネットワーク解析：基礎編

- 心理ネットワーク解析は新しい方法だが，偏相関をエッジとしたネットワークを描く方法と考えると難しくない。
- 便利なRパッケージも増えており実施も簡単になっているが，モデル選択やエッジ・中心性指標の評価などは理論的な理解も必要になる。
- 日々新しい方法の開発がなされており，解析法の推奨も変化しているので，アムステルダム大学の[Psych Systems](http://psychosystems.org/)のサイトを確認したり，最新の動向を抑えておく必要がある。
- 配布ドキュメントでは，IsingモデルやMGMsを用いた解析の実施法やより詳細な説明などを書いているので，ご一読ください。

---
## 参考文献
.med[
- Blanken, T. F., Isvoranu, A. M., &amp; Epskamp, S. (2022). Chapter 7. Estimating network structures using model selection. In Isvoranu, A. M., Epskamp, S., Waldorp, L. J., &amp; Borsboom, D. (Eds.). Network psychometrics with R: A guide for behavioral and social scientists. Routledge, Taylor &amp; Francis Group.
- Epskamp, S., Haslbeck, J. M. B., Isvoranu, A. M., &amp; Van Borkulo, C. D. (2022). Chapter 6. Pairwise Markov random fields. In Isvoranu, A. M., Epskamp, S., Waldorp, L. J., &amp; Borsboom, D. (Eds.). Network psychometrics with R: A guide for behavioral and social scientists. Routledge, Taylor &amp; Francis Group.
- Epskamp, S., Borsboom, D., &amp; Fried, E. I. (2018). Estimating psychological networks and their accuracy: A tutorial paper. Behavior Research Methods, 50(1), 195–212.
- Epskamp, S., Waldorp, L. J., Mõttus, R., &amp; Borsboom, D. (2018). The Gaussian Graphical Model in Cross-Sectional and Time-Series Data. Multivariate Behavioral Research, 53(4), 453–480.
]

---
## 参考文献
.med[
- Epskamp, S., Maris, G., Waldorp, L. J., &amp; Borsboom, D. (2018). Network Psychometrics. In The Wiley Handbook of Psychometric Testing (pp. 953–986). John Wiley &amp; Sons, Ltd.
- Fried, E. I., Epskamp, S., Veenman, M., &amp; van Borkulo, C. D. (2022). Chapter 8. Network stability, comparison, and replicability. In Isvoranu, A. M., Epskamp, S., Waldorp, L. J., &amp; Borsboom, D. (Eds.). Network psychometrics with R: A guide for behavioral and social scientists. Routledge, Taylor &amp; Francis Group.
- Isvoranu, A., &amp; Epskamp, S. (2021, January 26). Which Estimation Method to Choose in Network Psychometrics? Deriving Guidelines for Applied Researchers.
- Jones, P. J., Ma, R., &amp; McNally, R. J. (2021). Bridge Centrality: A Network Approach to Understanding Comorbidity. Multivariate Behavioral Research, 56(2), 353–367.
- Jordan, P., Shedden-Mora, M. C., &amp; Löwe, B. (2017). Psychometric analysis of the Generalized Anxiety Disorder scale (GAD-7) in primary care using modern item response theory. PloS One, 12(8), e0182162.
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
